<link rel="stylesheet" href="css/jigsaw.css">
<script src="js/jquery.js"></script>
<script src="js/layui/layui.all.js"></script>
<meta content="telephone=no" name="format-detection">
<style>

</style>
<!--用户注册-->
<div class="Headline-register">
    <!--滑动验证-->
    <div class="slide-verification">
        <div class="container">
            <div id="captcha" style="position: relative"></div>
        </div>
    </div>
    <!--注册账户-->
    <form action="" onsubmit="return false">
        <div class="reg-FraDiv-frame" id="reg-FraDiv-frame" type="1">
            <div class="reg-FraDiv" id="reg-FraDiv">

                <div class="registerTitle">
                    注册账户
                    <div class="guanbi" id="guanbi">
                        <img src="images/guanbi.png" alt="">
                    </div>

                </div>
                <!--输入手机号-->
                <div class="cell-phone-number">
                    <input type="text" placeholder="请输入手机号码" class="cell-phone-number-input">
                </div>
                <!--点击按钮开始验证-->
                <button class="VerificationImgBtn">
                    <img src="images/VerificationImgBtn.png" alt="" class="VerificationImg">
                    <span>点击按钮开始验证</span>
                </button>
                <!--验证码-->
                <div class="Verification-Code" >
                    <input type="text" placeholder="验证码" class="Verification-Code-input">
                    <button class="Verification-Code-btn" id="Verification-Code-btn" onclick='send_yzm(this)' type="1">发送验证码</button>
                </div>
                <!--密码-->
                <div class="password">
                    <input type="password" placeholder="密码">
                </div>
                <div class="password">
                    <input type="password" placeholder="再次输入密码" class="againNewPassword">
                </div>
                <!--提交按钮-->
                <button class="submitBtn">
                    注册
                </button>
                <!--已有账户,直接登录>-->
                <div class="Sign-in-frame">
                    已有账户，直接登录>
                </div>
            </div>
        </div>
    </form>
    <!--登录-->
    <form action="" onsubmit="return false">
        <div class="SignFrame" id="SignFrame" type="1">
            <div class="reg-FraDiv">
                <div class="registerTitle">
                    账号密码登录
                    <span class="reg-newAccount">注册新账号></span>
                    <div class="guanbi">
                        <img src="images/guanbi.png" alt="">
                    </div>
                </div>
                <!--输入手机号-->
                <div class="cell-phone-number">
                    <input type="text" placeholder="请输入手机号码" class="cell-phone-number-input">
                </div>
                <!--密码-->
                <div class="password">
                    <input type="password" placeholder="密码">
                </div>
                <!--忘记密码-->
                <div class="findPassword">
                    忘记密码
                </div>
                <!--提交按钮-->
                <button class="submitBtn">
                    确定
                </button>
                <!--短信登录-->
                <div class="SMS-login">
                    短信登录
                </div>
            </div>
        </div>
    </form>
    <!--找回密码-->
    <form action="" onsubmit="return false">
        <div class="retrieve-password-frame" id="retrieve-password-frame">
            <div class="reg-FraDiv">

                <div class="registerTitle">
                    找回密码
                    <div class="guanbi">
                        <img src="images/guanbi.png" alt="">
                    </div>

                </div>
                <!--输入手机号-->
                <div class="cell-phone-number">
                    <input type="text" placeholder="请输入手机号码" class="cell-phone-number-input">
                </div>
                <!--点击按钮开始验证-->
                <button class="VerificationImgBtn">
                    <img src="images/VerificationImgBtn.png" alt="" class="VerificationImg">
                    <span>点击按钮开始验证</span>
                </button>
                <!--验证码-->
                <div class="Verification-Code">
                    <input type="text" placeholder="验证码" class="Verification-Code-input">
                    <button class="VerificationFindpassword" id="VerificationFindpassword" onclick='send_yzm(this)' type="3">发送验证码</button>
                </div>
                <!--密码-->
                <div class="password">
                    <input type="password" placeholder="输入新密码" class="newPassword">
                </div>
                <div class="password">
                    <input type="password" placeholder="再次输入密码" class="againNewPassword">
                </div>
                <!--提交按钮-->
                <button class="submitBtn">
                    确定
                </button>
                <!--已有账户,直接登录>-->
                <div class="Sign-in-frame">
                    已有账户,直接登录>
                </div>
            </div>
        </div>
    </form>
    <!--短信登录-->
    <form action="" onsubmit="return false">
        <div class="SMSLogin-frame" id="SMSLogin-frame" type="2">
            <div class="reg-FraDiv">
                <div class="registerTitle">
                    短信登录
                    <div class="guanbi">
                        <img src="images/guanbi.png" alt="">
                    </div>

                </div>
                <!--输入手机号-->
                <div class="cell-phone-number">
                    <input type="text" placeholder="请输入手机号码" class="cell-phone-number-input">
                </div>
                <!--点击按钮开始验证-->
                <button class="VerificationImgBtn">
                    <img src="images/VerificationImgBtn.png" alt="" class="VerificationImg">
                    <span>点击按钮开始验证</span>
                </button>
                验证码
                <div class="Verification-Code">
                    <input type="text" placeholder="验证码" class="Verification-Code-input">
                    <button class="VerificationCodeLogin" onclick='send_yzm(this)' type="2">发送验证码</button>
                </div>
                <!--提交按钮-->
                <button class="submitBtn">
                    确定
                </button>
                <!--账号登录-->
                <div class="account-login">
                    账号登录
                </div>
            </div>
        </div>
    </form>

</div>
<!--旧导航-->
<div class="nav-header">
    <!--蚂蚁logo-->
    <div class="nav-My-logo">
        <div class="My-logo">
            <a href="/news/all"><img src="images/logoAA.png" alt="" class="QuKlogo"></a>
            <img src="images/logoAB.png" alt="" class="future-logo">
        </div>
    </div>

    <div class="nav-header-list">
        <ul class="header-list">
            <!--<li>-->
            <!--<div class="sub-page">-->
            <!--<div class="sub-page-first"  onclick='window.location.href="/anthome"' dom-i18n='header01'>首页</div>-->
            <!--</div>-->
            <!--</li>-->
            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/tophome"' dom-i18n='header01'>首页</div>
                    <!--<div class="sub-page-navH">-->
                    <!--<div class="sub-page-nav padd-T" onclick='window.location.href="/news/all"' dom-i18n='header021'>新闻动态</div>-->
                    <!--<div class="sub-page-nav"  onclick='window.location.href="/message"' dom-i18n='header022'>快讯</div>-->
                    <!--</div>-->
                </div>
            </li>

            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/antmap/recom"' dom-i18n='header03'>蚂蚁导航</div>
                    <div class="sub-page-navH">
                        <!--&lt;!&ndash;{foreach name='cateList' item='vo' }&ndash;&gt;-->
                        <!--<div class="sub-page-nav" onclick='window.location.href="/antmap/{$vo['id']}"'>{$vo.name}</div>-->
                        <!--&lt;!&ndash;{/foreach}&ndash;&gt;-->
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/1"' dom-i18n='header031'>行情</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/2"' dom-i18n='header032'>资产管理</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/3"' dom-i18n='header033'>应用</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/4"' dom-i18n='header034'>钱包</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/5"' dom-i18n='header035'>矿池</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/6"' dom-i18n='header036'>媒体</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/7"' dom-i18n='header037'>技术服务</div>
                        <div class="sub-page-nav" onclick='window.location.href="/antmap/8"' dom-i18n='header038'>社区</div>
                    </div>
                </div>
            </li>
            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/message"'>7*24快讯</div>
                </div>
            </li>
            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/activit/all/all"' dom-i18n='header04'>活动</div>
                    <div class="sub-page-navH">
                        <div class="sub-page-nav" onclick='window.location.href="/activit/1/all"' dom-i18n='header041'>报名中</div>
                        <div class="sub-page-nav padd-T" onclick='window.location.href="/activit/2/all"' dom-i18n='header042'>已结束</div>
                    </div>
                </div>
            </li>
            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/Columns"' dom-i18n='header06'>专栏</div>
                </div>
            </li>
            <li>
                <div class="sub-page">
                    <div class="sub-page-first" onclick='window.location.href="/description"' dom-i18n='header05'>关于我们</div>
                    <!--<div class="sub-page-navH">-->
                    <!--<div class="sub-page-nav" onclick='window.location.href="/description"' dom-i18n='header051'>简介</div>-->
                    <!--<div class="sub-page-nav"  onclick='window.location.href="/aboutus"' dom-i18n='header052'>团队</div>-->
                    <!--<div class="sub-page-nav padd-T"  onclick='window.location.href="/contactus"' dom-i18n='header053'>联系我们</div>-->
                    <!--</div>-->
                </div>
            </li>
        </ul>
        <!--{if condition="$loginInfo"}-->
        <!--登录时状态-->
        <div class="when-landing when-landing-Ac">
            <div class="when-landing-Img">
                <img src="{$loginInfo['portrait']}" alt="" style="border-radius: 50%">
            </div>
            <div class="usernamenumber">
                <span class="usernamenumber">{$loginInfo['nickname']}</span>
            </div>
            <div class="user-window">
                <ul>
                    <li onclick='window.location.href="/Home/User/myPage"' >我的主页</li>
                    <li id="Switch-users">切换账户</li>
                    <li id="Log-out">退出登录</li>
                </ul>

            </div>
        </div>
        <!--{else /}-->
        <!--未登录时状态-->
        <div class="userbtn">
            <div class="register">注册</div>
            <div class="Sign-in">登录</div>
        </div>
        <!--{/if}-->
    </div>

    <div class="search">
        <input type="text" placeholder="搜索" class="search-i">
        <span class="search-s">
            <img src="images/SearchK.png" alt="">
        </span>
    </div>

</div>

<script src="js/i18n.js"></script>
<script src="js/jigsaw.js"></script>
<script src="js/commom.js"></script>

<script>

    $("#AcEwmClose").click(function () {
        $(".activitsPopupbtnEwm").hide();
        location.reload()
    });

    
    $("#zcAciticty").click(function () {
        $("#reg-FraDiv-frame").show();
        $(".Headline-register").show();
        $("#retrieve-password-frame").hide();
        $("#SignFrame").hide();
        $("#SMSLogin-frame").hide();
        $(".activitsPopupbtn").hide()
    });

    layui.use('layer', function(){  //layer弹框
        var layer = layui.layer;
    });

    var countdown =60;
    var Timeid;
    //倒计时
    function send_yzm(val){
        var valClass=val.className;
        // console.log($('.'+valClass+'').parent().siblings(".VerificationImgBtn"));
         var yzm=$('.'+valClass+'').parent().siblings(".VerificationImgBtn")
        // var valClass=val.className;
        var phone = $('.'+valClass+'').parent().siblings(".cell-phone-number").find("input").val();
        // console.log($('.'+valClass+'').attr("type"))
        var type=$('.'+valClass+'').attr("type");
        // if(yzm.hasClass("wyx")==false){
        //     layer.msg('请点击按钮进行图形验证');
        //     return false
        // }
        $.ajax({
            type:"post",
            url:"/Home/User/send_code",
            data:{phone:phone,type:type},
            dataType:'json',
            success:function(data){
                console.log(data);
                // console.log(data.data)
                // return false;
                if(data.code==1){
                    settime(val)
                }
                if(data.code==3){
                    layer.msg(data.info+"，距离下次发送还有"+(60-(data.data))+"秒");
                }
                else{
                    layer.msg(data.info);
                }
            }
        });
    }
    /*倒计时*/
        function settime(val){
            var valClass=val.className;
            if (countdown == 0){
                $('.'+valClass+'').css({
                    "pointer-events":"",
                    "background":"#0c7ff2"
                });
                val.innerHTML = "发送验证码";
                countdown = 60;
                return false
            }
            else {
                $('.'+valClass+'').css({
                    "pointer-events":"none",
                    "background":"#aaaaaa"
                });
                val.innerHTML = "重新发送(" + countdown + ")";
                countdown--;
                // console.log(countdown)
            }
            Timeid=setTimeout(function() {
                    settime(val);
                }, 1000);
        }

    $(document).ready(function() {
        if($(".when-landing").hasClass("when-landing-Ac")){
            $(".activitsPopupbtn").hide()
        }
    });



    /*四个表单提交*/
    /*注册登录*/
    $(document).on('click','#reg-FraDiv-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#reg-FraDiv-frame .cell-phone-number-input").val();
        var password=$("#reg-FraDiv-frame .password input").val();
        var Verification_Code=$("#reg-FraDiv-frame .Verification-Code-input").val();
        var repassword=$("#reg-FraDiv-frame .againNewPassword").val();
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        if($("#reg-FraDiv-frame .VerificationImgBtn").hasClass("wyx")==false){
            layer.msg('请点击按钮进行图形验证');
            return false
        }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        if(password==''||password=='null'){
            layer.msg('您的密码不能为空');
            return false
        }
        if(password!=repassword){
            layer.msg('两次输入的密码不一致');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/register",
                data:{phone:phone_number,code:Verification_Code,repassword:repassword,password:password},
                dataType:'json',
                success:function(data){
                    // console.log(data);
                    if(data.code==1){
                        layer.msg('注册成功');
                        // location.reload()
                        $(".activitsPopupbtnEwm").show();
                        $(".Headline-register").hide()

                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });
     /*账号密码登录*/
    $(document).on('click','#SignFrame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#SignFrame .cell-phone-number-input").val();
        var password=$("#SignFrame .password input").val();
        var type=$("#SignFrame").attr("type");
        console.log(type);
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        if(password==''||password=='null'){
            layer.msg('您的密码不能为空');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/accountLogin",
                data:{phone:phone_number,password:password,type:type},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){
                        // console.log(data.data.nickname)
                        layer.msg('登录成功');
                        location.reload();
                        $(".userbtn").hide();
                        $(".when-landing").show();
                        $(".usernamenumber").html(data.data.nickname);
                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });
    /*找回密码*/
    $(document).on('click','#retrieve-password-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#retrieve-password-frame .cell-phone-number-input").val();
        var againNewPassword=$("#retrieve-password-frame .againNewPassword").val();
        var newPassword=$("#retrieve-password-frame .newPassword").val();
        var Verification_Code=$("#retrieve-password-frame .Verification-Code-input").val();

        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        if($("#retrieve-password-frame .VerificationImgBtn").hasClass("wyx")==false){
            layer.msg('请点击按钮进行图形验证');
            return false
        }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        if(newPassword==''||newPassword=='null'){
            layer.msg('新密码不能为空');
            return false
        }
        if(againNewPassword==''||againNewPassword=='null'){
            layer.msg('请核对新密码');
            return false
        }
        if(newPassword!=againNewPassword){
            layer.msg('输入的两次密码不吻合');
            return false
        }

        else {
            $.ajax({
                type:"post",
                url:"/Home/User/getPassword",
                data:{phone:phone_number,password:newPassword,repassword:againNewPassword,code:Verification_Code},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){ // 显示用户数据 隐藏输入框
                        layer.msg('修改成功');
                        location.reload()
                    }else{
                        layer.msg(data.info);
                        // console.log(data.info);
                    }
                }
            });
        }
    });
    /*短信登录*/
    $(document).on('click','#SMSLogin-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#SMSLogin-frame .cell-phone-number-input").val();
        var Verification_Code=$("#SMSLogin-frame .Verification-Code-input").val();
        var type=$("#SMSLogin-frame").attr("type");
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        if($("#SMSLogin-frame .VerificationImgBtn").hasClass("wyx")==false){
            layer.msg('请点击按钮进行图形验证');
            return false
        }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/accountLogin",
                data:{phone:phone_number,code:Verification_Code,type:type},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){
                        layer.msg('登录成功');
                        location.reload()
                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });





    /*滑动验证*/

     $(document).on('click','.VerificationImgBtn',function() {
        var $this=$(this);
        $(".slide-verification").show();
        $(this).css({
            "pointer-events":"none"
        });
        jigsaw.init(document.getElementById('captcha'), function () {
            $(".slide-verification").hide();
            $this.css({
                "border":"1px #26c267 solid",
                "color":"#26c267",
                "background":"#eefff5"
            });
            $this.find('span').html("验证成功");
            $this.find('img').css({
                "width":"5%",
                "top":"15.5px",
                "left":"128px"
            });
            $this.find('img').attr("src","/themes/default/images/successA.png");
            $this.addClass("wyx");
            $("#captcha").load(location.href + " #captcha")
        })

    });
    /*关闭弹窗*/
    $(document).on('click','.guanbi',function() {
         $(".Headline-register").hide()
    });

    /*注册*/
    $(document).on('click','.register',function() {
        $("#reg-FraDiv-frame").show();
        $(".Headline-register").show()
        $("#retrieve-password-frame").hide();
        $("#SignFrame").hide();
        $("#SMSLogin-frame").hide()
    });
    /*登录*/
    $(document).on('click','.Sign-in',function() {
        $("#SignFrame").show();
        $("#reg-FraDiv-frame").hide();
        $(".Headline-register").show();
        $("#retrieve-password-frame").hide();
        $("#SMSLogin-frame").hide()
    });
    /*注册新账号*/
    $(document).on('click','.reg-newAccount',function() {
        $("#reg-FraDiv-frame").show();
        $("#SignFrame").hide();
        $("#retrieve-password-frame").hide();
        clearTimeout(Timeid);
        countdown =60;
        $("#reg-FraDiv-frame").load(location.href + " #reg-FraDiv-frame")
    })
    /*找回密码*/
    $(document).on('click','.findPassword',function() {
        $("#reg-FraDiv-frame").hide();
        $("#SignFrame").hide();
        $("#retrieve-password-frame").show();
        clearTimeout(Timeid);
        countdown =60;
        $("#retrieve-password-frame").load(location.href + " #retrieve-password-frame")
    });
    /*直接登录*/
    $(document).on('click','.Sign-in-frame',function() {
        $("#reg-FraDiv-frame").hide();
        $("#SignFrame").show();
        $("#retrieve-password-frame").hide();
        clearTimeout(Timeid);
        countdown =60;

    });
    /*账号登录*/
    $(document).on('click','.account-login',function() {
        $("#SignFrame").show();
        $(".SMSLogin-frame").hide()
    });
    /*短信登录*/
    $(document).on('click','.SMS-login',function() {
        $("#SignFrame").hide();
        $(".SMSLogin-frame").show();
        clearTimeout(Timeid);
        countdown =60;
        $("#SMSLogin-frame").load(location.href + " #SMSLogin-frame")
    });


    // $(".userbtn").click(function () {
    //     layer.msg('暂未开放');
    // })

    /*搜索功能*/
$('.search-s').click(function(){
    var keyword = $('.search-i').val();
    // console.log(keyword)
    window.location.href="/search/"+keyword;
});


    $( '.search-i').focus( function(){
        document.onkeydown = function(e){
            var ev = document.all ? window.event : e;
            if(ev.keyCode==13) {
                var keyword = $('.search-i').val();
                // console.log(keyword)
                window.location.href="/search/"+keyword;
            }
        };
        $(this).attr("placeholder","")
    } );
    $('.search-i').blur(function(){
            $(this).attr("placeholder","搜索")
    });




    $(".bscriptionBtn").click(function () {
        var type=$(".bscriptionBtn").attr("type");
        // console.log(type);
        // console.log(author_id);
        // return false;
        $.ajax({
            type:"post",
            url:"/Home/User/subscribeAuthor",
            data:{author_id:author_id,type:type},
            dataType:'json',
            success:function(data){
                // console.log(data);
                if(data.code==1){
                    layer.msg(data.info);
                }else{
                    layer.msg(data.info);
                }
            }
        });
    });
  /*退出登录*/
    $("#Log-out").click(function () {
        $.ajax({
            type:"post",
            url:"/Home/User/logout",
            data:{},
            dataType:'json',
            success:function(data){
                console.log(data);
                if(data.code==1){
                    layer.msg(data.info);
                    setTimeout(function () {
                        location.reload();
                    },1000)
                }else{

                    // console.log(data.info);
                    layer.msg(data.info);
                }
            }
        });
    });
    /*切换用户*/
    $("#Switch-users").click(function () {
        $.ajax({
            type:"post",
            url:"/Home/User/logout",
            data:{},
            dataType:'json',
            success:function(data){
                console.log(data.code);
                if(data.code==1){
                    layer.msg("切换成功");
                    setTimeout(function () {
                        location.reload();
                    },1000)
                }else{
                    // console.log(data.info);
                    layer.msg(data.info);
                }
            }
        });
    })

</script>
        