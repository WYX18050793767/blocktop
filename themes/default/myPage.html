<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>区块链头条_区块链头条官网</title>
    <meta name="baidu-site-verification" content="" />
    <meta name="keywords" content="区块链头条,区块链头条官网,区块链,区块链技术,比特币,区块链媒体"/>
    <meta name="description" content=""/>
    <meta name="referrer" content="never">
    <link rel="stylesheet" href="css/common.css?1254">
    <link rel="stylesheet" href="css/NewsInformation.css">
    <link rel="stylesheet" href="css/specialColumn.css">

</head>
<style>
    * {
        -webkit-box-sizing: unset!important;
        -moz-box-sizing: unset!important;
         box-sizing: unset!important;
    }
    *:before,
    *:after {
        -webkit-box-sizing: unset!important;
        -moz-box-sizing: unset!important;
        box-sizing: unset!important;
    }
    .future-logo{
        top: 0!important;
    }
    body{
        background: white!important;
    }
    .userBackground{
        width: 1200px;
        margin: 0 auto;
        height: 170px;
        background: url("/Public/img/UserBackground.png")no-repeat top;
        background-size: 100% 100%;
        overflow: hidden;
    }
    .userContent{
        width: 90%;
        margin: 30px auto 0 auto;
        height: 100px;
        position: relative;
    }
    .upgrade{
        width: 115px;
        height: 35px;
        background: #D40507;
        position: absolute;
        right: 0;
        top: 40px;
        line-height: 35px;
        text-align: center;
        color: white;
        font-size: 13px;
        letter-spacing: 1px;
        cursor:no-drop;
    }
    .usertopImg{
       width: 10%;
        height: 100%;
        float: left;
        margin-top: 8px;
    }
    .usertopImg-Tx img{
       width: 100%;

    }
    .usertopImg-Tx{
        width: 84px;
        height: 84px;
        border-radius: 50%;
        overflow: hidden;
    }
    .modifyinformation{
        width: 90%;
        height: 100%;
        float: left;
        padding-top: 20px;
        font-size: 18px;
    }
    .modifysonp span{
        margin-right: 60px;
        font-size: 15px;
    }
    .modifysonp{
        margin-top: 12px;
    }
    .modifyUserName{
        cursor: pointer;
    }
    .modifyUserName img{
        position: relative;
        top: -2px;
    }
    .InpUserName{
        border: none;
        background: transparent;
        outline: none;
        pointer-events: none;
        font-size: 18px;
        color: black;
    }
    .InpUserName::placeholder{
        color: black;
    }
    .subhis{
        width: 1200px;
        margin: 30px auto 0 auto;
    }
    .subhis ul{
        width: 100%;

    }
    .subhis ul li{
        width: 13%;
        text-align: center;
        float: left;
        font-size: 25px;
        font-weight: 300;
        cursor: pointer;
    }
    .subhis ul li:nth-child(1){
        font-weight: bold;
    }
    .subscription{
        width: 1200px;
        margin: 0px auto;
        clear: both;
        padding-top: 20px;

    }
    .subscription ul li{
        height: 150px;
        width: 95%;
        margin: 0 auto;
        position: relative;
        border-bottom: 1px solid #f0f0f0;
    }
    .subscription-Tx{
        width: 105px;
        height: 105px;
        margin-top: 22px;
    }
    .subscriptionContent{
        width: 88%;
        float: right;
        position: relative;
        padding-top: 40px;
    }
    .subscriptionTitle{
        font-size: 23px;
    }
    .subscriptionText{
        font-size: 18px;
        color: #b9b9b9;
        margin-top: 10px;
    }
    .bscriptionBtn{
        width:120px ;
        height: 35px;
        background: #999999;
        color: white;
        line-height: 35px;
        text-align: center;
        position: absolute;
        right: 0;
        top: 60px;
        border-radius: 4px;
        cursor: pointer;
    }
    .historyrecord{
        width: 1200px;
        margin: 0 auto;
        display: none;
        clear: both;
    }
    .column-special{
        width: 325px;
        float: right;
        background: white;
        position: relative;
        bottom: 0;
        min-height: 0px;
        border: 1px #e0e3e7 solid;
        border-radius: 4px;
        margin-bottom: 30px;
    }
    .headImageNameTc{
        position:fixed ;
        background: rgba(0,0,0,.5);
        width: 100%;
        height: 100%;
        z-index: 1000;
        display: none;
    }
    .headImageNameTcDo{
        background: white;
        position: absolute;
        margin: auto;
        right: 0;
        left: 0;
        top: 0;
        bottom: 0;
        height: 412px;
        width: 440px;
        border-radius: 8px;
    }
    .txxg{
        width: 141px;
        height: 141px;
        margin: 30px auto 0 auto;
        border-radius: 50%;
        background: #00aff2;
        background: url("images/xiugaiUsered.png")top center;
        background-size: 100% 100%;
        position: relative;
        overflow: hidden;

    }
    .txxgbtn{
        width:100% ;
        height: 40px;
        position: absolute;
        background: rgba(0,0,0,.4)no-repeat top;
        bottom: 0;
        line-height: 30px;
        text-align: center;
        color: white;
        letter-spacing: 1px;
        cursor: pointer;
    }
    .title-RevisedInfor{
        margin: 0 auto;
        width: 80%;
        text-align: left;
        font-size: 22px;
        padding-top: 40px;
    }
    .nickname{
        width: 100%;
        text-align: center;
        margin-top: 30px;
    }
    .nicknameXg{
        width: 270px;
        height: 30px;
        border: 1px #e0e3e7 solid;
        border-radius: 4px;
    }
    .confirmbtn{
        width:151px ;
        height: 36px;
        background: #0c7ff2;
        border-radius: 6px;
        margin: 0 auto;
        color: white;
        text-align: center;
        line-height: 36px;
        font-size: 18px;
        margin-top: 30px;
        cursor: pointer;
    }
    .closebtn{
        position: absolute;
        right: 35px;
        top: 45px;
        cursor: pointer;
    }
    .upgradeCodeEwm{
        width: 100%;
        height: 100%;
        position: fixed;
    }
    .upgradeCodeEwmDiv{
        width: 190px;
        height: 190px;
        background: rgba(0,0,0,.5);
        position: absolute;
        right: 0;
        left: 0;
        bottom: 0;
        top: -80px;
        margin: auto;
        border-radius: 8px;
        color: white;
        text-align: center;
        font-size: 12px;
        overflow: hidden;
        display: none;
    }
    .TtCodeImg{
        width: 100px;
        height: 100px;
        position: relative;
        top: 30px;
    }
    .CodeGuanbi{
        position: absolute;
        right: 10px;
        top: 5px;
        cursor: pointer;
    }
    .CodeGuanbi img{
        width: 15px;
        height: 15px;
        margin-top: 5px;
    }
</style>
<body>
   <div class="box">
       <!--升级头条作者弹窗-->
       <div class="upgradeCodeEwm">
           <div class="upgradeCodeEwmDiv">
               <div class="CodeGuanbi">
                   <img src="images/guanbi.png" alt="">
               </div>

               <img src="images/TtCode.jpg" alt="" class="TtCodeImg">
               <div style="margin-top: 44px">该功能暂未开放</div>
               <div>详情可咨询微信官方客服。</div>
           </div>
       </div>
       <!--导航栏-->
       <!--弹窗（修改头像名字）-->
       <div class="headImageNameTc">
           <div class="headImageNameTcDo">
               <!--关闭按钮-->
               <div class="closebtn">
                   <img src="images/guanbi.png" alt="">
               </div>
               <!--修改资料-->
               <form id='user-form' enctype="multipart/form-data">
               <div class="RevisedInformation">
                   <div class="title-RevisedInfor">修改资料</div>
                   <!--上传头像-->
                   <div class="txxg" >
                       <img src="{$userInfo.portrait|default='/Public/img/portrait.png'}" alt="" class="txxg-Img" width="100%">
                       <input name='portrait' value='' type="hidden" id="portrait">
                       <div class="txxgbtn" data-toggle="modal" data-target="#avatar-modal">
                           <!--<button type="button" class="btn"  data-toggle="modal" data-target="#avatar-modal">-->
                               <!--修改头像-->
                           <!--</button>-->
                           修改头像
                       </div>
                   </div>
                   <!--昵称-->
                   <div class="nickname">
                       <span>昵称 : </span>
                       <input name='nickname' value='{$userInfo.nickname}' type="text" placeholder="输入新昵称" class="nicknameXg">
                   </div>

                   <div class="confirmbtn">
                       确认
                   </div>
               </div>
               </form>

           </div>

       </div>
       <!--#include file="header.html"-->
       <div class="userBackground">
           <div class="userContent">
               <!--用户头像-->
               <div class="usertopImg">
                   <div class="usertopImg-Tx">
                       <img src="{$userInfo.portrait|default='/Public/img/portrait.png'}" alt="" width="100%">
                   </div>
               </div>
               <!--修改区-->
               <div class="modifyinformation">
                   <p>
                       <input type="text" placeholder="{$userInfo.nickname}" class="InpUserName">
                       <span class="modifyUserName"><img src="images/xiugaiUser.png" alt="修改"></span>
                   </p>
                   <p class="modifysonp">
                       <span>注册时间 : {$userInfo.create_time|format_time='Y年m月d日'}</span>
                       <span>UID : {$userInfo.top_num}</span>
                       <span>订阅作者 :  <span style="color: #D40507;font-size: 18px">{$userInfo.subscribe}</span></span>
                   </p>
               </div>
               <!--升级头条作者-->
               <div class="upgrade">
                   升级头条作者
               </div>

           </div>
       </div>
       <!--主要内容-->
       <div class="subscription-history">
           <!--我的订阅和游览历史-->
           <div class="subhis">
               <ul>
                   <li>我的订阅</li>
                   <li>浏览历史</li>
               </ul>
           </div>
           <!--subscription-->
           <div class="subscription">
              <!--{if condition="$subscribeList"}-->
              <ul>
                  <!--{foreach name='subscribeList' item='vo' }-->
                   <li data='{$vo.id}' onclick='window.location.href="/Author/{$vo.id}"'>
                       <img src="images/xiugaiUsered.png" alt="" class="subscription-Tx">
                       <div class="subscriptionContent">
                           <p class="subscriptionTitle">{$vo.nickname}</p>
                           <p class="subscriptionText">{$vo.desc}</p>
                       </div>
                       <div class="bscriptionBtn" onclick='subscribe(this)' type='2'>
                            取消订阅
                       </div>
                   </li>
                   <!--{/foreach}-->
              </ul>
              <!--{else /}-->
              <ul>
                <div class="NewType-Content">
                     <span>还未有订阅作者</span>
                </div>
              </ul>
               <!--{/if}-->
           </div>



           <!--history-->
           <div class="historyrecord">
               <!--{if condition="$historyList"}-->
               <div class="NewType-Content">

                   <ul>
                       <!--{foreach name='historyList' item='vo' }-->
                       <li onclick='window.location.href="/newsContent/{$vo.content_id}"'>
                           <div class="NewType-Detail">
                               <div class="NewTypeImg">
                                   <div class="NewTypeImgBox">
                                       <img src="{$vo.image}" alt="">
                                   </div>

                               </div>
                               <div class="NewTypeText">
                                   <div class="TextTitle">
                                       {$vo.title}
                                   </div>
                                   <div class="TextContent">
                                       {$vo.description}
                                   </div>
                                   <div class="TextSource">
                                       <span class="roof-placement">置顶</span>
                                       <span>{$vo.author}</span>
                                       <span>{$vo.time|format_time='Y/m/d H:i'}</span>
                                       <span class="Guankan"><img src="images/guankan.png" alt="" width="15px">{$vo.views}</span>
                                   </div>
                               </div>
                           </div>
                       </li>
                       <!--{/foreach}-->
                   </ul>
                   <div class="LookMore">
                       <span id='news_more'>查看更多</span>
                   </div>
               </div>
               <!--{else /}-->
               <div class="NewType-Content">
                   <span>没有找到相关内容</span>
               </div>
               <!--{/if}-->
               <!--专栏-->
               <div class="column-special">
                   <div class="Column-ranking-picture">
                       <img src="images/columbTitle.png" alt="">
                   </div>
                   <ul class="Column-ranking-ul">
                       <!--{foreach name='columnList' item='vo' }-->
                       <li onclick='window.location.href="/Columns/{$vo.id}"'>
                           <div class="numRank">{$key+1}</div>
                           <div class="rankImg">
                               <img src="{$vo.icon}" alt="">
                           </div>
                           <div class="rankContent">
                               <p class="rankContentA">{$vo.name}</p>
                               <p class="rankContentB">{$vo.desc}</p>
                           </div>
                       </li>
                       <!--{/foreach}-->
                   </ul>
               </div>
           </div>
       </div>
       <link rel="stylesheet" href="/themes/default/TxXg/css/bootstrap-3.3.4.css">
       <link rel="stylesheet" href="/themes/default/TxXg/css/cropper.min.css">
       <link rel="stylesheet" href="/themes/default/TxXg/css/font-awesome.4.6.0.css">
       <link rel="stylesheet" href="/themes/default/TxXg/css/qunit.css">
       <link rel="stylesheet" href="/themes/default/TxXg/css/sitelogo.css">


       <div class="user_pic">
           <img src=""/>
       </div>

       <div class="modal fade" id="avatar-modal" aria-hidden="true" aria-labelledby="avatar-modal-label" role="dialog" tabindex="-1">
           <div class="modal-dialog modal-lg">
               <div class="modal-content">
                   <!--<form class="avatar-form" action="upload-logo.php" enctype="multipart/form-data" method="post">-->
                   <form class="avatar-form">
                       <div class="modal-header">
                           <button class="close" data-dismiss="modal" type="button">&times;</button>
                           <h4 class="modal-title" id="avatar-modal-label">上传图片</h4>
                       </div>
                       <div class="modal-body">
                           <div class="avatar-body">
                               <div class="avatar-upload">
                                   <input class="avatar-src" name="avatar_src" type="hidden">
                                   <input class="avatar-data" name="avatar_data" type="hidden">
                                   <label for="avatarInput" style="line-height: 35px;">图片上传</label>
                                   <button class="btn btn-danger"  type="button" style="height: 35px;" onclick="$('input[id=avatarInput]').click();">请选择图片</button>
                                   <span id="avatar-name"></span>
                                   <input class="avatar-input hide" id="avatarInput" name="avatar_file" type="file"></div>
                               <div class="row">
                                   <div class="col-md-9">
                                       <div class="avatar-wrapper"></div>
                                   </div>
                                   <div class="col-md-3">
                                       <div class="avatar-preview preview-lg" id="imageHead"></div>
                                       <!--<div class="avatar-preview preview-md"></div>
                               <div class="avatar-preview preview-sm"></div>-->
                                   </div>
                               </div>
                               <div class="row avatar-btns">
                                   <div class="col-md-4">
                                       <div class="btn-group">
                                           <button class="btn btn-danger fa fa-undo" data-method="rotate" data-option="-90" type="button" title="Rotate -90 degrees"> 向左旋转</button>
                                       </div>
                                       <div class="btn-group">
                                           <button class="btn  btn-danger fa fa-repeat" data-method="rotate" data-option="90" type="button" title="Rotate 90 degrees"> 向右旋转</button>
                                       </div>
                                   </div>
                                   <div class="col-md-5" style="text-align: right;opacity: 0;pointer-events: none">
                                       <button class="btn btn-danger fa fa-arrows" data-method="setDragMode" data-option="move" type="button" title="移动">
							            <span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="$().cropper(&quot;setDragMode&quot;, &quot;move&quot;)">
							            </span>
                                       </button>
                                       <button type="button" class="btn btn-danger fa fa-search-plus" data-method="zoom" data-option="0.1" title="放大图片">
							            <span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="$().cropper(&quot;zoom&quot;, 0.1)">
							              <!--<span class="fa fa-search-plus"></span>-->
							            </span>
                                       </button>
                                       <button type="button" class="btn btn-danger fa fa-search-minus" data-method="zoom" data-option="-0.1" title="缩小图片">
							            <span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="$().cropper(&quot;zoom&quot;, -0.1)">
							              <!--<span class="fa fa-search-minus"></span>-->
							            </span>
                                       </button>
                                       <button type="button" class="btn btn-danger fa fa-refresh" data-method="reset" title="重置图片">
								            <span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="$().cropper(&quot;reset&quot;)" aria-describedby="tooltip866214">
                                       </button>
                                   </div>
                                   <div class="col-md-3">
                                       <button class="btn btn-danger btn-block avatar-save fa fa-save" type="button" data-dismiss="modal"> 保存修改</button>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </form>
               </div>
           </div>
       </div>

       <div class="loading" aria-label="Loading" role="img" tabindex="-1"></div>


       <!--底部-->
       <!--#include file="footer.html"-->
   </div>

</body>
</html>

<script src="/themes/default/TxXg/js/jquery-1.10.2.js"></script>
<script src="/themes/default/TxXg/js/bootstrap-3.3.4.js"></script>
<script src="/themes/default/TxXg/js/sitelogo.js"></script>
<script src="/themes/default/TxXg/js/qunit.js"></script>
<script src="/themes/default/TxXg/js/cropper.min.js"></script>
<script src="/themes/default/TxXg/js/cropper.js"></script>
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/layui/layui.all.js"></script>
<script src="/themes/default/TxXg/js/html2canvas.min.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
    //做个下简易的验证  大小 格式
    $('#avatarInput').on('change', function(e) {
        var filemaxsize = 1024 * 5;//5M
        var target = $(e.target);
        var Size = target[0].files[0].size / 1024;
        if(Size > filemaxsize) {
            alert('图片过大，请重新选择!');
            $(".avatar-wrapper").childre().remove;
            return false;
        }
        if(!this.files[0].type.match(/image.*/)) {
            alert('请选择正确的图片!')
        } else {
            var filename = document.querySelector("#avatar-name");
            var texts = document.querySelector("#avatarInput").value;
            var teststr = texts; //你这里的路径写错了
            testend = teststr.match(/[^\\]+\.[^\(]+/i); //直接完整文件名的
            filename.innerHTML = testend;
        }

    });

    $(".avatar-save").on("click", function() {
        var img_lg = document.getElementById('imageHead');
        // 截图小的显示框内的内容
        html2canvas(img_lg, {
            allowTaint: true,
            taintTest: false,
            onrendered: function(canvas) {
                canvas.id = "mycanvas";
                //生成base64图片数据
                var dataUrl = canvas.toDataURL("image/jpeg");
                var newImg = document.createElement("img");
                newImg.src = dataUrl;
                console.log(dataUrl);
                $('.txxg-Img').attr('src',dataUrl );
                $('#portrait').val(dataUrl);
            }
        });
    });




    var page_num = 2;

    $(".closebtn").click(function () {
        $(".headImageNameTc").hide()
    });
    $(".modifyUserName img").click(function () {
        $(".headImageNameTc").show()
        // $(".InpUserName").css({
        //     ".pointer-events":"all",
        // });
        // $(".InpUserName").focus();
    });


    layui.use('layer', function(){  //layer弹框
        var layer = layui.layer;
    });
    /*升级头条作者弹窗*/
    $(".upgrade").click(function () {
        $(".upgradeCodeEwmDiv").show();
    });
    
    $(".CodeGuanbi").click(function () {
        $(".upgradeCodeEwmDiv").hide()
    });
    /*修改资料提交*/

    $('.confirmbtn').click(function(){

        $.ajax({
            type:"post",
            url:"/Home/User/changeInfo",
            data:$("#user-form").serialize(),
            dataType:'json',
            success:function(rdata){

                if(rdata.code==1){
                  //更新导航栏
                  $(".usertopImg-Tx img").attr("src",rdata.data.portrait);
                  $(".usernamenumber span").html(rdata.data.nickname);

                  //更新个人主页
                  $(".when-landing-Img img").attr("src",rdata.data.portrait);
                  $(".InpUserName").attr("value",$(".usernamenumber span").text());
                  $(".headImageNameTc").hide()
                  layer.msg(rdata.info);
                }else{
                    layer.msg(rdata.info);
                }
            }
        });
    })

    /*我的订阅与浏览历史切换*/
    $(".subhis ul li").click(function () {
       var $this=$(this);
       $this.css({
           "font-weight":"bold"
       });
        $this.siblings().css({
            "font-weight":"300"
        });
       console.log($this.index());
       if($this.index()==0){
          $(".subscription").show();
          $(".historyrecord").hide();
       }else {
           $(".subscription").hide();
           $(".historyrecord").show()
       }
    });


    $('#news_more').click(function(){
        $.ajax({
            type:"post",
            url:"/Home/Ajax/get_history",
            data:{page_num:page_num},
            dataType:'json',
            success:function(rdata){
                // console.log(rdata)
                if(rdata.code==1){
                    $('.NewType-Content ul').append(rdata.data);
                    page_num++;
                }else{
                    $('#news_more').html(rdata.info);
                }
            }
        });
    });

    function subscribe(para){
        var o  = $(para);
        var type = o.attr("type");
        var author_id=o.parent('li').attr("data");


        $.ajax({
            type:"post",
            url:"/Home/User/subscribeAuthor",
            data:{author_id:author_id,type:type},
            dataType:'json',
            success:function(data){
                // console.log(data);
                if(data.code==1){
                    layer.msg(data.info);
                        /*订阅与取消订阅按钮*/

                    if(type==1){
                        o.css({
                            "background":"#999999"
                        });
                        o.html("取消订阅");
                        o.attr("type","2")
                    }else {
                        o.css({
                            "background":"#D40507"
                        });
                        o.html("+订阅");
                        o.attr("type","1")
                    }

                }else{
                    layer.msg(data.info);
                }
            }
        });
    }

</script>