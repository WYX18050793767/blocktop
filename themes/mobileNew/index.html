<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>区块链头条</title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <script>
        (function (doc, win) {
            var docEl = doc.documentElement,
                resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                recalc = function () {
                    var clientWidth = docEl.clientWidth;
                    if (!clientWidth) return;
                    if(clientWidth>=640){
                        docEl.style.fontSize = '100px';
                    }else{
                        docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
                    }
                };
            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);
    </script>
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/common.css">
    <script src="/themes/default/js/layui/layui.all.js"></script>

</head>

<body>
    <div class="box">
        <!--#include file="header.html"-->
        <!--轮播图-->
        <div class="bannerImg">
            <!--轮播-->
            <div id="slideBox" class="slideBox">
                <div class="bd">
                    <ul>
                        <!--{foreach name='bannerList' item='vo' }-->
                        <li>
                            <a class="pic" href="{$vo.target}"><img src="{$vo.path}" /></a>
                            <a class="tit" href="#"></a>
                        </li>
                        <!--{/foreach}-->
                    </ul>
                </div>
                <div class="hd">
                    <ul></ul>
                </div>
            </div>
            <!--<div class="bannerImgBox">-->
                <!--<img src="images/banner.png" alt="">-->
            <!--</div>-->
        </div>
        <!--文章分类-->
        <div class="ArticleType">
            <div class="ArticleTypeBox">
                <ul>
                    <li onclick='window.location.href="/home_m/all"'>今日头条</li>
                    <!--{foreach name='newsCate' item='vo' }-->
                    <li class='<!--{if condition="$class_id eq $vo['class_id']"}--> active <!--{/if}-->'>
                        <a href = '/home_m/{$vo.class_id}'>{$vo.name}</a>
                    </li>
                    <!--{/foreach}-->
                </ul>
            </div>
        </div>
        <!--{if condition="$class_id lt 6"}-->
        <!--各个文章-->
        <div class="variousArticles">
            <div class="variousArticlesBox">
                <ul>
                    <!--{foreach name='newsList' item='vo' }-->
                    <li>
                        <!--配图-->
                        <div class="ArticlesBanner">
                            <img src="{$vo.image}" alt="">
                        </div>
                        <!--标题概述-->
                        <div class="ArticlesText">
                            <div class="ArticlesTitle"  onclick='window.location.href="/newsContent_m/1/{$vo.content_id}"'>
                                {$vo.title}
                            </div>
                            <div class="ArticlesTime">
                                <!--{if condition="$vo['author_id']"}-->
                                <span onclick='window.location.href="/Author/{$vo.author_id}"'>{$vo.author_name}</span>
                                <!--{else /}-->
                                <span>{$vo.author}</span>
                                <!--{/if}-->
                                <span class="TimeHa">{$vo.time|format_time='Y/m/d H:i'}</span>
                            </div>

                        </div>
                    </li>
                    <!--{/foreach}-->
                </ul>

            </div>
            <!--更多-->
             <div class="moreArticles">
                 <img src="images/moremore.png" alt="">
             </div>
        </div>
        <!--{else /}-->
        <div class="NewType-Content">
            <span>没有找到相关内容</span>
        </div>
        <!--{/if}-->
        <!--底部-->
        <!--#include file="footer.html"-->
    </div>

</body>
</html>
<script src="js/jquery.js"></script>
<script src="js/common.js"></script>
<script src="/themes/mobileNew/js/TouchSlide.1.1.js"></script>


<script>

    TouchSlide({
        slideCell:"#slideBox",
        titCell:".hd ul", //开启自动分页 autoPage:true ，此时设置 titCell 为导航元素包裹层
        mainCell:".bd ul",
        effect:"leftLoop",
        autoPage:true,//自动分页
        autoPlay:true //自动播放
    });
</script>
<script>
    layui.use('layer', function(){  //layer弹框
        var layer = layui.layer;
    });
    var countdown =60;
    var Timeid;
    //倒计时
    function send_yzm(val){
        var valClass=val.className;
        // console.log($('.'+valClass+'').parent().siblings(".VerificationImgBtn"));
        var yzm=$('.'+valClass+'').parent().siblings(".VerificationImgBtn")
        // var valClass=val.className;
        var phone = $('.'+valClass+'').parent().siblings(".cell-phone-number").find("input").val();
        // console.log($('.'+valClass+'').attr("type"))
        var type=$('.'+valClass+'').attr("type");
        // if(yzm.hasClass("wyx")==false){
        //     layer.msg('请点击按钮进行图形验证');
        //     return false
        // }
        $.ajax({
            type:"post",
            url:"/Home/User/send_code",
            data:{phone:phone,type:type},
            dataType:'json',
            success:function(data){
                console.log(data);
                // console.log(data.data)
                // return false;
                if(data.code==1){
                    settime(val)
                }
                if(data.code==3){
                    layer.msg(data.info+"，距离下次发送还有"+(60-(data.data))+"秒");
                }
                else{
                    layer.msg(data.info);
                }
            }
        });
    }
    /*倒计时*/
    function settime(val){
        var valClass=val.className;
        if (countdown == 0){
            $('.'+valClass+'').css({
                "pointer-events":"",
                "background":"#0c7ff2"
            });
            val.innerHTML = "发送验证码";
            countdown = 60;
            return false
        }
        else {
            $('.'+valClass+'').css({
                "pointer-events":"none",
                "background":"#aaaaaa"
            });
            val.innerHTML = "重新发送(" + countdown + ")";
            countdown--;
            // console.log(countdown)
        }
        Timeid=setTimeout(function() {
            settime(val);
        }, 1000);
    }

    $(document).ready(function() {
        if($(".when-landing").hasClass("when-landing-Ac")){
            $(".activitsPopupbtn").hide()
        }
    });



    /*四个表单提交*/
    /*注册登录*/
    $(document).on('click','#reg-FraDiv-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#reg-FraDiv-frame .cell-phone-number-input").val();
        var password=$("#reg-FraDiv-frame .password input").val();
        var Verification_Code=$("#reg-FraDiv-frame .Verification-Code-input").val();
        var repassword=$("#reg-FraDiv-frame .againNewPassword").val();
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        // if($("#reg-FraDiv-frame .VerificationImgBtn").hasClass("wyx")==false){
        //     layer.msg('请点击按钮进行图形验证');
        //     return false
        // }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        if(password==''||password=='null'){
            layer.msg('您的密码不能为空');
            return false
        }
        if(password!=repassword){
            layer.msg('两次输入的密码不一致');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/register",
                data:{phone:phone_number,code:Verification_Code,repassword:repassword,password:password},
                dataType:'json',
                success:function(data){
                    // console.log(data);
                    if(data.code==1){
                        layer.msg('注册成功');
                        // location.reload()
                        $(".activitsPopupbtnEwm").show();
                        $(".Headline-register").hide()

                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });
    /*账号密码登录*/
    $(document).on('click','#SignFrame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#SignFrame .cell-phone-number-input").val();
        var password=$("#SignFrame .password input").val();
        var type=$("#SignFrame").attr("type");
        console.log(type);
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        if(password==''||password=='null'){
            layer.msg('您的密码不能为空');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/accountLogin",
                data:{phone:phone_number,password:password,type:type},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){
                        // console.log(data.data.nickname)
                        layer.msg('登录成功');
                        location.reload();
                        $(".userbtn").hide();
                        $(".when-landing").show();
                        $(".usernamenumber").html(data.data.nickname);
                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });
    /*找回密码*/
    $(document).on('click','#retrieve-password-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#retrieve-password-frame .cell-phone-number-input").val();
        var againNewPassword=$("#retrieve-password-frame .againNewPassword").val();
        var newPassword=$("#retrieve-password-frame .newPassword").val();
        var Verification_Code=$("#retrieve-password-frame .Verification-Code-input").val();

        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        // if($("#retrieve-password-frame .VerificationImgBtn").hasClass("wyx")==false){
        //     layer.msg('请点击按钮进行图形验证');
        //     return false
        // }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        if(newPassword==''||newPassword=='null'){
            layer.msg('新密码不能为空');
            return false
        }
        if(againNewPassword==''||againNewPassword=='null'){
            layer.msg('请核对新密码');
            return false
        }
        if(newPassword!=againNewPassword){
            layer.msg('输入的两次密码不吻合');
            return false
        }

        else {
            $.ajax({
                type:"post",
                url:"/Home/User/getPassword",
                data:{phone:phone_number,password:newPassword,repassword:againNewPassword,code:Verification_Code},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){ // 显示用户数据 隐藏输入框
                        layer.msg('修改成功');
                        location.reload()
                    }else{
                        layer.msg(data.info);
                        // console.log(data.info);
                    }
                }
            });
        }
    });
    /*短信登录*/
    $(document).on('click','#SMSLogin-frame .submitBtn',function() {
        var number = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;
        var phone_number=$("#SMSLogin-frame .cell-phone-number-input").val();
        var Verification_Code=$("#SMSLogin-frame .Verification-Code-input").val();
        var type=$("#SMSLogin-frame").attr("type");
        if(phone_number==''||phone_number=='null'){
            layer.msg('您的电话不能为空');
            return false
        }
        if(!number.test(phone_number)){
            layer.msg('手机号码不正确，请重新输入');
            return false
        }
        // if($("#SMSLogin-frame .VerificationImgBtn").hasClass("wyx")==false){
        //     layer.msg('请点击按钮进行图形验证');
        //     return false
        // }
        if(Verification_Code==''||Verification_Code=='null'){
            layer.msg('您的验证码不能为空');
            return false
        }
        else {
            $.ajax({
                type:"post",
                url:"/Home/User/accountLogin",
                data:{phone:phone_number,code:Verification_Code,type:type},
                dataType:'json',
                success:function(data){
                    console.log(data);
                    if(data.code==1){
                        layer.msg('登录成功');
                        location.reload()
                    }else{
                        // console.log(data.info);
                        layer.msg(data.info);
                    }
                }
            });
        }
    });

    /*关闭弹窗*/
    $(document).on('click','.guanbi',function() {
        $(".Headline-register").hide()
    });
    /*注册*/
    $(document).on('click','.registerbtn',function() {
        $("#reg-FraDiv-frame").show();
        $(".Headline-register").show()
        $("#retrieve-password-frame").hide();
        $("#SignFrame").hide();
        $("#SMSLogin-frame").hide()
    });
    /*登录*/
    $(document).on('click','.signInbtn',function() {
        $("#SignFrame").show();
        $("#reg-FraDiv-frame").hide();
        $(".Headline-register").show();
        $("#retrieve-password-frame").hide();
        $("#SMSLogin-frame").hide()
    });
    /*注册新账号*/
    $(document).on('click','.reg-newAccount',function() {
        $("#reg-FraDiv-frame").show();
        $("#SignFrame").hide();
        $("#retrieve-password-frame").hide();
        clearTimeout(Timeid);
        countdown =60;
        $("#reg-FraDiv-frame").load(location.href + " #reg-FraDiv-frame")
    })
    /*找回密码*/
    $(document).on('click','.findPassword',function() {
        $("#reg-FraDiv-frame").hide();
        $("#SignFrame").hide();
        $("#retrieve-password-frame").show();
        clearTimeout(Timeid);
        countdown =60;
        $("#retrieve-password-frame").load(location.href + " #retrieve-password-frame")
    });
    /*直接登录*/
    $(document).on('click','.Sign-in-frame',function() {
        $("#reg-FraDiv-frame").hide();
        $("#SignFrame").show();
        $("#retrieve-password-frame").hide();
        clearTimeout(Timeid);
        countdown =60;

    });
    /*账号登录*/
    $(document).on('click','.account-login',function() {
        $("#SignFrame").show();
        $(".SMSLogin-frame").hide()
    });
    /*短信登录*/
    $(document).on('click','.SMS-login',function() {
        $("#SignFrame").hide();
        $(".SMSLogin-frame").show();
        clearTimeout(Timeid);
        countdown =60;
        $("#SMSLogin-frame").load(location.href + " #SMSLogin-frame")
    });
</script>